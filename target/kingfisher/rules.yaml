rules:
  - name: GitHub Personal Access Token
    id: S3IGSE57RML77YEIXF5X
    pattern: (?:\A|\W)(ghp_[0-9A-Za-z]{36})(?:\W|\z)
    min_entropy: 2.0
    confidence: high
    references:
      - https://github.blog/engineering/platform-security/behind-githubs-new-authentication-token-formats/
      - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens
    visibile: true
    validation:
      type: Http
      content:
        request:
          method: POST
          url: https://api.github.com/user
          headers:
            Accept: application/vnd.github.v3+json
            Authorization: Bearer {{ TOKEN }}
          response_matcher:
            - type: JsonValid
            - type: StatusMatch
              status:
                - 200
              negative: false
            - type: ReportResponse
              report_response: true
  - name: GitHub Fine-Grained Personal Access Token
    id: S3IGA2DTZOHC3DRBHIJQ
    pattern: (?:\A|\W)(github_pat_\w{82})(?:\W|\z)
    min_entropy: 2.0
    confidence: high
    references:
      - https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens
    visibile: true
    validation:
      type: Http
      content:
        request:
          method: POST
          url: https://api.github.com/user
          headers:
            Accept: application/vnd.github.v3+json
            Authorization: Bearer {{ TOKEN }}
          response_matcher:
            - type: JsonValid
            - type: StatusMatch
              status:
                - 200
              negative: false
            - type: ReportResponse
              report_response: true

